{% with current=request.resolver_match.url_name %}
  <aside class="site-settings-sidebar rounded-3xl border border-[color:var(--admin-border)] bg-[color:var(--admin-surface)] p-5 shadow-sm">
    <div class="flex items-center justify-between">
      <div class="site-settings-sidebar-content text-xs font-semibold uppercase tracking-[0.2em] text-[color:var(--admin-muted)]">
        Site settings
      </div>
      <button
        type="button"
        class="site-settings-toggle flex h-8 w-8 items-center justify-center rounded-full border border-[color:var(--admin-border)] text-xs font-semibold text-[color:var(--admin-ink)] transition hover:bg-[color:var(--admin-bg)]"
        aria-label="Collapse sidebar"
        aria-expanded="true"
        title="Collapse sidebar"
      >
        <span class="toggle-icon" aria-hidden="true">&lsaquo;</span>
      </button>
    </div>
    <nav class="site-settings-sidebar-content mt-4 flex flex-col gap-2 text-sm font-semibold">
      <a
        href="{% url 'site_admin:site_settings' %}"
        class="rounded-2xl px-4 py-2 transition {% if current == 'site_settings' %}bg-[color:var(--admin-bg)] text-[color:var(--admin-ink)]{% else %}text-[color:var(--admin-muted)] hover:bg-[color:var(--admin-bg)] hover:text-[color:var(--admin-ink)]{% endif %}"
      >
        General
      </a>
      <a
        href="{% url 'site_admin:theme_settings' %}"
        class="rounded-2xl px-4 py-2 transition {% if current == 'theme_settings' or current == 'theme_file_edit' or current == 'theme_install_detail' %}bg-[color:var(--admin-bg)] text-[color:var(--admin-ink)]{% else %}text-[color:var(--admin-muted)] hover:bg-[color:var(--admin-bg)] hover:text-[color:var(--admin-ink)]{% endif %}"
      >
        Themes
      </a>
      <a
        href="{% url 'site_admin:menu_list' %}"
        class="rounded-2xl px-4 py-2 transition {% if current == 'menu_list' or current == 'menu_create' or current == 'menu_edit' or current == 'menu_item_delete' %}bg-[color:var(--admin-bg)] text-[color:var(--admin-ink)]{% else %}text-[color:var(--admin-muted)] hover:bg-[color:var(--admin-bg)] hover:text-[color:var(--admin-ink)]{% endif %}"
      >
        Menus
      </a>
      <a
        href="{% url 'site_admin:indieauth_settings' %}"
        class="rounded-2xl px-4 py-2 transition {% if current == 'indieauth_settings' or current == 'indieauth_client_detail' %}bg-[color:var(--admin-bg)] text-[color:var(--admin-ink)]{% else %}text-[color:var(--admin-muted)] hover:bg-[color:var(--admin-bg)] hover:text-[color:var(--admin-ink)]{% endif %}"
      >
        IndieAuth
      </a>
      {% if settings.developer_tools_enabled %}
        <a
          href="{% url 'site_admin:error_log_list' %}"
          class="rounded-2xl px-4 py-2 transition {% if current == 'error_log_list' or current == 'error_log_detail' %}bg-[color:var(--admin-bg)] text-[color:var(--admin-ink)]{% else %}text-[color:var(--admin-muted)] hover:bg-[color:var(--admin-bg)] hover:text-[color:var(--admin-ink)]{% endif %}"
        >
          Error logs
        </a>
      {% endif %}
    </nav>
  </aside>
  <style>
    @media (min-width: 1024px) {
      .site-settings-layout.is-sidebar-collapsed {
        grid-template-columns: 56px 1fr;
      }
    }

    .site-settings-layout.is-sidebar-collapsed .site-settings-sidebar {
      padding: 1rem;
    }

    .site-settings-layout.is-sidebar-collapsed .site-settings-sidebar .site-settings-sidebar-content {
      display: none;
    }
  </style>
  <script>
    (() => {
      const layout = document.querySelector(".site-settings-layout");
      if (!layout) return;
      const toggle = layout.querySelector(".site-settings-toggle");
      if (!toggle) return;
      const storageKey = "site-settings-sidebar-collapsed";
      const icon = layout.querySelector(".toggle-icon");
      const applyState = (collapsed) => {
        layout.classList.toggle("is-sidebar-collapsed", collapsed);
        if (!icon) return;
        icon.innerHTML = collapsed ? "&rsaquo;" : "&lsaquo;";
        toggle.setAttribute("aria-label", collapsed ? "Expand sidebar" : "Collapse sidebar");
        toggle.setAttribute("aria-expanded", collapsed ? "false" : "true");
        toggle.setAttribute("title", collapsed ? "Expand sidebar" : "Collapse sidebar");
      };
      const stored = localStorage.getItem(storageKey) === "1";
      applyState(stored);
      toggle.addEventListener("click", () => {
        const next = !layout.classList.contains("is-sidebar-collapsed");
        localStorage.setItem(storageKey, next ? "1" : "0");
        applyState(next);
      });
    })();
  </script>
{% endwith %}
